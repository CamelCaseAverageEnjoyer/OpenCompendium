'''
Файл сгененрирован программой OpenCompendium/RnD-PhD/notebooks/dynamic.ipynb (Раздел: Генерация файла H.matrix.py)
Копия файла из каталога OpenCompendium/RnD-PhD/notebooks/dynamic.ipynb     ycharmProjects/PythonCompendium/DissertationPhd/storage/observability_mapping_partial_derivatives.py
'''
import numpy as np
from flexmath import *

def h_element(gm_1: str, gm_2: str, fn, cn, relation, angles_navigation, r1, r2, r_f, q_f, multy_antenna_send: bool, multy_antenna_take: bool, w_0: float, t: float, q1: None, q2: None):
    '''
    :param fn: Количество дочерних КА
    :param cn: Количество материнских КА
    :param relation: Измерения материнский-дочерний КА (cd) или дочерний-дочерний КА (dd) 
    :param angles_navigation: Оценивается ли вращательное движение
    :param r1: Положение 1-го КА
    :param r2: Положение 2-го КА
    :param r_f: Положения дочерних КА
    :param q_f: Вектор-часть кватернионов ориентации дочерних КА
    :param multy_antenna_send: Раскладывается ли сигнал при отправке
    :param multy_antenna_take: Раскладывается ли сигнал при принятии
    :param w_0: Угловая скорость вращения ОСК относительно ИСК
    :param t: Текущее время
    :param q1: Вектор-часть кватерниона 1-го КА (при angles_navigation=True)
    :param q2: Вектор-часть кватерниона 2-го КА (при angles_navigation=True)
    '''
    from flexmath import pi

    ff_sequence = []  # Последовательность номеров непустых столбцов, длина ff_sequence - кол-во строк нижней подматицы
    for i_f1 in range(fn):
        for i_f2 in range(i_f1):
            if i_f1 != i_f2:
                ff_sequence += [[i_f1, i_f2]]

    r1_x, r1_y, r1_z = r1
    r2_x, r2_y, r2_z = r2
    r12x = r1_x - r2_x
    r12y = r1_y - r2_y
    r12z = r1_z - r2_z
    r12 = sqrt(r12x**2 + r12y**2 + r12z**2)
    if q1 is not None:
        q1_x, q1_y, q1_z = q1
        q1_0 = sqrt(1 - q1_x**2 - q1_y**2 - q1_z**2)
    if q2 is not None:
        q2_x, q2_y, q2_z = q2
        q2_0 = sqrt(1 - q2_x**2 - q2_y**2 - q2_z**2)
    pi = pi(r1_x)

    
    s1_11 = 1.0*(2*q1_x*q1_y + 2*q1_z*sqrt(-q1_x**2 - q1_y**2 - q1_z**2 + 1))*cos(t*w_0) - 1.0*(-2*q1_y**2 - 2*q1_z**2 + 1)*sin(t*w_0)
    s1_12 = 2.0*q1_x*q1_z - 2.0*q1_y*sqrt(-q1_x**2 - q1_y**2 - q1_z**2 + 1)
    s1_13 = 1.0*(2*q1_x*q1_y + 2*q1_z*sqrt(-q1_x**2 - q1_y**2 - q1_z**2 + 1))*sin(t*w_0) + 1.0*(-2*q1_y**2 - 2*q1_z**2 + 1)*cos(t*w_0)
    s1_21 = -1.0*(2*q1_x*q1_y - 2*q1_z*sqrt(-q1_x**2 - q1_y**2 - q1_z**2 + 1))*sin(t*w_0) + 1.0*(-2*q1_x**2 - 2*q1_z**2 + 1)*cos(t*w_0)
    s1_22 = 2.0*q1_x*sqrt(-q1_x**2 - q1_y**2 - q1_z**2 + 1) + 2.0*q1_y*q1_z
    s1_23 = 1.0*(2*q1_x*q1_y - 2*q1_z*sqrt(-q1_x**2 - q1_y**2 - q1_z**2 + 1))*cos(t*w_0) + 1.0*(-2*q1_x**2 - 2*q1_z**2 + 1)*sin(t*w_0)
    s1_31 = -1.0*(2*q1_x*q1_z + 2*q1_y*sqrt(-q1_x**2 - q1_y**2 - q1_z**2 + 1))*sin(t*w_0) + 1.0*(-2*q1_x*sqrt(-q1_x**2 - q1_y**2 - q1_z**2 + 1) + 2*q1_y*q1_z)*cos(t*w_0)
    s1_32 = -2.0*q1_x**2 - 2.0*q1_y**2 + 1.0
    s1_33 = 1.0*(2*q1_x*q1_z + 2*q1_y*sqrt(-q1_x**2 - q1_y**2 - q1_z**2 + 1))*cos(t*w_0) + 1.0*(-2*q1_x*sqrt(-q1_x**2 - q1_y**2 - q1_z**2 + 1) + 2*q1_y*q1_z)*sin(t*w_0)
    s2_11 = 1.0*(2*q2_x*q2_y + 2*q2_z*sqrt(-q2_x**2 - q2_y**2 - q2_z**2 + 1))*cos(t*w_0) - 1.0*(-2*q2_y**2 - 2*q2_z**2 + 1)*sin(t*w_0)
    s2_12 = 2.0*q2_x*q2_z - 2.0*q2_y*sqrt(-q2_x**2 - q2_y**2 - q2_z**2 + 1)
    s2_13 = 1.0*(2*q2_x*q2_y + 2*q2_z*sqrt(-q2_x**2 - q2_y**2 - q2_z**2 + 1))*sin(t*w_0) + 1.0*(-2*q2_y**2 - 2*q2_z**2 + 1)*cos(t*w_0)
    s2_21 = -1.0*(2*q2_x*q2_y - 2*q2_z*sqrt(-q2_x**2 - q2_y**2 - q2_z**2 + 1))*sin(t*w_0) + 1.0*(-2*q2_x**2 - 2*q2_z**2 + 1)*cos(t*w_0)
    s2_22 = 2.0*q2_x*sqrt(-q2_x**2 - q2_y**2 - q2_z**2 + 1) + 2.0*q2_y*q2_z
    s2_23 = 1.0*(2*q2_x*q2_y - 2*q2_z*sqrt(-q2_x**2 - q2_y**2 - q2_z**2 + 1))*cos(t*w_0) + 1.0*(-2*q2_x**2 - 2*q2_z**2 + 1)*sin(t*w_0)
    s2_31 = -1.0*(2*q2_x*q2_z + 2*q2_y*sqrt(-q2_x**2 - q2_y**2 - q2_z**2 + 1))*sin(t*w_0) + 1.0*(-2*q2_x*sqrt(-q2_x**2 - q2_y**2 - q2_z**2 + 1) + 2*q2_y*q2_z)*cos(t*w_0)
    s2_32 = -2.0*q2_x**2 - 2.0*q2_y**2 + 1.0
    s2_33 = 1.0*(2*q2_x*q2_z + 2*q2_y*sqrt(-q2_x**2 - q2_y**2 - q2_z**2 + 1))*cos(t*w_0) + 1.0*(-2*q2_x*sqrt(-q2_x**2 - q2_y**2 - q2_z**2 + 1) + 2*q2_y*q2_z)*sin(t*w_0)



    
    # if angles_navigation:
    swt = sin(t*w_0)
    cwt = cos(t*w_0)
    s1_x_r12 = s1_11*(r12x) + s1_12*(r12y) + s1_13*(r12z)
    s1_y_r12 = s1_21*(r12x) + s1_22*(r12y) + s1_23*(r12z)
    s1_z_r12 = s1_31*(r12x) + s1_32*(r12y) + s1_33*(r12z)
    s2_x_r12 = s2_11*(r12x) + s2_12*(r12y) + s2_13*(r12z)
    s2_y_r12 = s2_21*(r12x) + s2_22*(r12y) + s2_23*(r12z)
    s2_z_r12 = s2_31*(r12x) + s2_32*(r12y) + s2_33*(r12z)
    s1_r12 = sqrt((s1_x_r12)**2 + (s1_y_r12)**2 + (s1_z_r12)**2)
    s2_r12 = sqrt((s2_x_r12)**2 + (s2_y_r12)**2 + (s2_z_r12)**2)
    s1_r12_2 = ((s1_x_r12)**2 + (s1_y_r12)**2 + (s1_z_r12)**2)
    s2_r12_2 = ((s2_x_r12)**2 + (s2_y_r12)**2 + (s2_z_r12)**2)

    s1_xyx = sqrt((s1_x_r12)**2 + (s1_y_r12)**2 + (s1_x_r12)**2)
    s1_xy = sqrt((s1_x_r12)**2 + (s1_y_r12)**2)
    s1_yz = sqrt((s1_y_r12)**2 + (s1_z_r12)**2)
    s1_xz = sqrt((s1_x_r12)**2 + (s1_z_r12)**2)
    s2_xyx = sqrt((s2_x_r12)**2 + (s2_y_r12)**2 + (s2_x_r12)**2)
    s2_xy = sqrt((s2_x_r12)**2 + (s2_y_r12)**2)
    s2_yz = sqrt((s2_y_r12)**2 + (s2_z_r12)**2)
    s2_xz = sqrt((s2_x_r12)**2 + (s2_z_r12)**2)

    s1_xyx_2 = ((s1_x_r12)**2 + (s1_y_r12)**2 + (s1_x_r12)**2)
    s1_xy_2 = ((s1_x_r12)**2 + (s1_y_r12)**2)
    s1_yz_2 = ((s1_y_r12)**2 + (s1_z_r12)**2)
    s1_xz_2 = ((s1_x_r12)**2 + (s1_z_r12)**2)
    s2_xyx_2 = ((s2_x_r12)**2 + (s2_y_r12)**2 + (s2_x_r12)**2)
    s2_xy_2 = ((s2_x_r12)**2 + (s2_y_r12)**2)
    s2_yz_2 = ((s2_y_r12)**2 + (s2_z_r12)**2)
    s2_xz_2 = ((s2_x_r12)**2 + (s2_z_r12)**2)

    c_s1_x = cos(pi*(s1_x_r12)/(2*s1_r12))
    c_s1_y = cos(pi*(s1_y_r12)/(2*s1_r12))
    c_s1_z = cos(pi*(s1_z_r12)/(2*s1_r12))
    c_s2_x = cos(pi*(s2_x_r12)/(2*s2_r12))
    c_s2_y = cos(pi*(s2_y_r12)/(2*s2_r12))
    c_s2_z = cos(pi*(s2_z_r12)/(2*s2_r12))

    q1_y_z2 = -2*q1_y**2 - 2*q1_z**2 + 1
    q1_x_z2 = -2*q1_x**2 - 2*q1_z**2 + 1
    q1_0z_xy1 = 2*q1_0*q1_z + 2*q1_x*q1_y
    q1_0z_xy2 = -2*q1_0*q1_z + 2*q1_x*q1_y
    q1_0y_xz1 = 2*q1_0*q1_y + 2*q1_x*q1_z
    q1_0x_yz2 = -2*q1_0*q1_x + 2*q1_y*q1_z

    q2_y_z2 = -2*q2_y**2 - 2*q2_z**2 + 1
    q2_x_z2 = -2*q2_x**2 - 2*q2_z**2 + 1
    q2_0z_xy1 = 2*q2_0*q2_z + 2*q2_x*q2_y
    q2_0z_xy2 = -2*q2_0*q2_z + 2*q2_x*q2_y
    q2_0y_xz1 = 2*q2_0*q2_y + 2*q2_x*q2_z
    q2_0x_yz2 = -2*q2_0*q2_x + 2*q2_y*q2_z
    
    if (angles_navigation==True) and (gm_1=='isotropic') and (gm_2=='isotropic'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2), ((2*r1_y - 2*r2_y)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2), ((2*r1_z - 2*r2_z)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2), (0), (0), (0), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (gm_1=='isotropic') and (gm_2=='1 antenna'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (gm_1=='isotropic') and (gm_2=='2 antennas'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 6*[0],
                       [((2*r1_x - 2*r2_x)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2) + 3*(s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2) + 3*(s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2) + 3*(s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0)))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (gm_1=='1 antenna') and (gm_2=='isotropic'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (0), (0), (0), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (gm_1=='1 antenna') and (gm_2=='1 antenna'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (gm_1=='1 antenna') and (gm_2=='2 antennas'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 6*[0],
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2) + 3*(s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2) + 3*(s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2) + 3*(s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0)))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (gm_1=='2 antennas') and (gm_2=='isotropic'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (0), (0), (0), ] + 6*[0],
                       [((2*r1_x - 2*r2_x)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (0), (0), (0), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (gm_1=='2 antennas') and (gm_2=='1 antenna'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 6*[0],
                       [((2*r1_x - 2*r2_x)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (gm_1=='2 antennas') and (gm_2=='2 antennas'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 6*[0],
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2) + 3*(s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2) + 3*(s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2) + 3*(s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0)))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 6*[0],
                       [((2*r1_x - 2*r2_x)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2) + 3*(s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 6*[0],
                       [((2*r1_x - 2*r2_x)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2) + 3*(s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_x*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x**2/q2_0 - 2*q2_0) - 1.0*swt*(-2*q2_x*q2_y/q2_0 + 2*q2_z)) + 2*(r12z)*(1.0*cwt*(-2*q2_x*q2_y/q2_0 + 2*q2_z) + 1.0*swt*(2*q2_x**2/q2_0 - 2*q2_0)))*(s2_z_r12) - (s2_x_r12)*(2.0*cwt*(r12x)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2.0*swt*(r12z)*(-2*q2_x*q2_z/q2_0 + 2*q2_y) + 2*(r12y)*(2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_x - 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)) + 2*(r12y)*(-2.0*q2_x**2/q2_0 + 2.0*q2_0) + 2*(r12z)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 4.0*q2_x*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2) + 3*(s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(-8.0*q2_y*(r12y) + 2*(r12x)*(1.0*cwt*(2*q2_x*q2_y/q2_0 + 2*q2_z) - 1.0*swt*(-2*q2_y**2/q2_0 + 2*q2_0)) + 2*(r12z)*(1.0*cwt*(-2*q2_y**2/q2_0 + 2*q2_0) + 1.0*swt*(2*q2_x*q2_y/q2_0 + 2*q2_z)))*(s2_z_r12) - (s2_x_r12)*(2*(r12x)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 4.0*q2_y*swt) + 2*(r12y)*(2.0*q2_y**2/q2_0 - 2.0*q2_0) + 2*(r12z)*(-4.0*cwt*q2_y + 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0))) - (s2_y_r12)*(2.0*cwt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12z) - 2.0*swt*(2*q2_x + 2*q2_y*q2_z/q2_0)*(r12x) + 2*(r12y)*(-2.0*q2_x*q2_y/q2_0 + 2.0*q2_z)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), (((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2) + 3*(s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0)))/(2*s2_r12_2) + 3*(s2_z_r12)**2*(-(2*(r12x)*(1.0*cwt*(2*q2_x*q2_z/q2_0 + 2*q2_y) - 1.0*swt*(2*q2_x - 2*q2_y*q2_z/q2_0)) + 2*(r12z)*(1.0*cwt*(2*q2_x - 2*q2_y*q2_z/q2_0) + 1.0*swt*(2*q2_x*q2_z/q2_0 + 2*q2_y)))*(s2_z_r12) - (s2_x_r12)*(2*(2.0*q2_x + 2.0*q2_y*q2_z/q2_0)*(r12y) + 2*(r12x)*(1.0*cwt*(-2*q2_z**2/q2_0 + 2*q2_0) + 4.0*q2_z*swt) + 2*(r12z)*(-4.0*cwt*q2_z + 1.0*swt*(-2*q2_z**2/q2_0 + 2*q2_0))) - (s2_y_r12)*(2*(r12x)*(-4.0*cwt*q2_z - 1.0*swt*(2*q2_z**2/q2_0 - 2*q2_0)) + 2*(r12y)*(-2.0*q2_x*q2_z/q2_0 + 2.0*q2_y) + 2*(r12z)*(1.0*cwt*(2*q2_z**2/q2_0 - 2*q2_0) - 4.0*q2_z*swt)))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 6*[0],
                       ])

    if (angles_navigation==False) and (gm_1=='isotropic') and (gm_2=='isotropic'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2), ((2*r1_y - 2*r2_y)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2), ((2*r1_z - 2*r2_z)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (gm_1=='isotropic') and (gm_2=='1 antenna'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (gm_1=='isotropic') and (gm_2=='2 antennas'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       [((2*r1_x - 2*r2_x)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (gm_1=='1 antenna') and (gm_2=='isotropic'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (gm_1=='1 antenna') and (gm_2=='1 antenna'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (gm_1=='1 antenna') and (gm_2=='2 antennas'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (gm_1=='2 antennas') and (gm_2=='isotropic'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       [((2*r1_x - 2*r2_x)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*(3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (gm_1=='2 antennas') and (gm_2=='1 antenna'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       [((2*r1_x - 2*r2_x)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (gm_1=='2 antennas') and (gm_2=='2 antennas'):
        return vec_type([
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       [((2*r1_x - 2*r2_x)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_y_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_y_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       [((2*r1_x - 2*r2_x)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_y_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_y_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       [((2*r1_x - 2*r2_x)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y + 2*q2_z*q2_0) + 2.0*swt*(q2_y_z2))*(s2_x_r12) - (-2.0*cwt*(-2*q2_x*q2_0 + 2*q2_y*q2_z) + 2.0*swt*(2*q2_x*q2_z + 2*q2_y*q2_0))*(s2_z_r12) - (-2.0*cwt*(q2_x_z2) + 2.0*swt*(2*q2_x*q2_y - 2*q2_z*q2_0))*(s2_y_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y + 2*q1_z*q1_0) + 2.0*swt*(q1_y_z2))*(s1_x_r12) - (-2.0*cwt*(-2*q1_x*q1_0 + 2*q1_y*q1_z) + 2.0*swt*(2*q1_x*q1_z + 2*q1_y*q1_0))*(s1_x_r12) - (-2.0*cwt*(q1_x_z2) + 2.0*swt*(2*q1_x*q1_y - 2*q1_z*q1_0))*(s1_y_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_y - 2*r2_y)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12)/(2*s2_r12_2) + 3*(4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-4.0*q2_x*q2_z + 4.0*q2_y*q2_0)*(s2_x_r12) - (-4.0*q2_x*q2_0 - 4.0*q2_y*q2_z)*(s2_y_r12) - (4.0*q2_x**2 + 4.0*q2_y**2 - 2.0)*(s2_z_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-4.0*q1_x*q1_z + 4.0*q1_y*q1_0)*(s1_x_r12) - (-4.0*q1_x*q1_0 - 4.0*q1_y*q1_z)*(s1_y_r12) - (4.0*q1_x**2 + 4.0*q1_y**2 - 2.0)*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ((2*r1_z - 2*r2_z)*((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)/((r12x)**2 + (r12y)**2 + (r12z)**2)**2 + ((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)**(3/2)*sqrt((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)*(3*(-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12)/(2*s2_r12_2) + 3*(-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12)/(2*s2_r12_2) + 3*(s2_x_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2) + 3*(s2_z_r12)**2*(-(-2.0*cwt*(2*q2_x*q2_y - 2*q2_z*q2_0) - 2.0*swt*(q2_x_z2))*(s2_y_r12) - (-2.0*cwt*(2*q2_x*q2_z + 2*q2_y*q2_0) - 2.0*swt*(-2*q2_x*q2_0 + 2*q2_y*q2_z))*(s2_z_r12) - (-2.0*cwt*(q2_y_z2) - 2.0*swt*(2*q2_x*q2_y + 2*q2_z*q2_0))*(s2_x_r12))/(2*s2_r12_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2) + sqrt((s1_x_r12)**2/s1_xyx_2 + (s1_x_r12)**2/s1_xyx_2)*((s2_x_r12)**2/s2_r12_2 + (s2_z_r12)**2/s2_r12_2)**(3/2)*(3*(-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12)/(2*s1_xyx_2) + 3*(-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12)/(2*s1_xyx_2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2) + 3*(s1_x_r12)**2*(-(-2.0*cwt*(2*q1_x*q1_y - 2*q1_z*q1_0) - 2.0*swt*(q1_x_z2))*(s1_y_r12) - (-2.0*cwt*(2*q1_x*q1_z + 2*q1_y*q1_0) - 2.0*swt*(-2*q1_x*q1_0 + 2*q1_y*q1_z))*(s1_x_r12) - (-2.0*cwt*(q1_y_z2) - 2.0*swt*(2*q1_x*q1_y + 2*q1_z*q1_0))*(s1_x_r12))/(2*s1_xyx_2**2))/((r12x)**2 + (r12y)**2 + (r12z)**2)), ] + 3*[0],
                       ])



def h_matrix(t, v, f, c, r_f, r_c, q_f, q_c: list, return_template: bool = False):
    '''Возвращает матрицу отображения наблюдаемости H = dz/dx. Только измерения RSSI
    :param c_ant: Количество антенн у материнского КА
    :param f_ant: Количество антенн у дочернего КА
    :param fn: Количество дочерних КА
    :param cn: Количество материнских КА
    :param angles_navigation: Оценивается ли вращательное движение
    :param r_f: Положения дочерних КА
    :param r_c: Положения материнских КА
    :param multy_antenna_send: Раскладывается ли сигнал при отправке
    :param multy_antenna_take: Раскладывается ли сигнал при принятии
    :param w_0: Угловая скорость вращения ОСК относительно ИСК
    :param t: Текущее время
    :param q_f: Вектор-часть кватернионов дочерних КА (при angles_navigation=True)
    :param q_c: Вектор-часть кватернионов материнских КА (при angles_navigation=True)
    :return: Матрица частных производных H - линеаризация отображения состояния в измерения.
    ''' 
    from sympy import var, Matrix
    from spacecrafts import get_gain
    from flexmath import zeros

    fn = f.n
    cn = c.n
    c_g = v.GAIN_MODEL_C
    f_g = v.GAIN_MODEL_F
    c_ant = v.N_ANTENNA_C
    f_ant = v.N_ANTENNA_F
    angles_navigation = v.NAVIGATION_ANGLES
    multy_antenna_send = v.MULTI_ANTENNA_SEND
    multy_antenna_take = v.MULTI_ANTENNA_TAKE
    w_0 = v.W_ORB

    f_take_len = len(get_gain(v=v, obj=f, r=np.ones(3), if_take=True))
    f_send_len = len(get_gain(v=v, obj=f, r=np.ones(3), if_send=True))
    
    ff_sequence = []  # Последовательность номеров непустых столбцов, длина ff_sequence - кол-во строк нижней подматицы
    for i_f1 in range(fn):
        for i_f2 in range(i_f1):
            if i_f1 != i_f2:
                ff_sequence += [[i_f1, i_f2]]

    H_cd = None
    for i_c in range(cn):
        row = []
        for i_f in range(fn):
            if return_template:
                row.append(Matrix([var('c_{' + str(i_c) + '}d_{' + str(i_f) + '}')]))
            else:
                row.append(h_element(gm_1=c_g, gm_2=f_g, fn=fn, cn=cn, relation='cd', angles_navigation=angles_navigation, r_f=r_f, r1=r_c[i_c], r2=r_f[i_f], q_f=q_f, q1=q_c[i_c], q2=q_f[i_f], multy_antenna_send=multy_antenna_send, multy_antenna_take=multy_antenna_take, w_0=w_0, t=t))
                
        row = block_diag(*row)
        H_cd = row if H_cd is None else vstack(H_cd, row)

    # >>>>>>>>>>>> Нижняя подматрица <<<<<<<<<<<<
    H_dd = None
    for i_y in range(len(ff_sequence)):  # то же самое, что range(int(fn*(fn-1)/2)):
        row = []
        for i_x in range(fn):
            if i_x in ff_sequence[i_y]:
                i_1, i_2 = ff_sequence[i_y] if i_x == ff_sequence[i_y][1] else ff_sequence[i_y][::-1]
                if return_template:
                    row.append(Matrix([var('d_{' + str(i_1) + '}d_{' + str(i_2) + '}')]))
                else:
                    row.append(h_element(gm_1=f_g, gm_2=f_g, fn=fn, cn=cn, relation="dd", angles_navigation=angles_navigation, r_f=r_f, r1=r_f[i_1], r2=r_f[i_2], q_f=q_f, q1=q_f[i_1], q2=q_f[i_2], multy_antenna_send=multy_antenna_send, multy_antenna_take=multy_antenna_take, w_0=w_0, t=t))
            else:
                if return_template:
                    row.append(Matrix([0]))
                else:
                    row.append(zeros((f_take_len * f_send_len, 12 if angles_navigation else 6), template=w_0))
        row = bmat(row)
        H_dd = row if H_dd is None else vstack(H_dd, row)   

    # >>>>>>>>>>>> Компановка <<<<<<<<<<<<
    return vstack(H_cd, H_dd) if H_dd is not None else H_cd
